% Use    $ latexmk -bibtex -pdf
\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
% 定义所有的图片文件在 figures 子目录下
\graphicspath{{figures/}}
\usepackage{textcomp}
\usepackage{xcolor}

%Customize
\usepackage{diagbox}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Misaka: Interactive Swarm Testbed for Smart Grid Distributed Algorithm Development Test and Evaluation\\}

\author{\IEEEauthorblockN{1\textsuperscript{st} Tingliang Zhang}
\IEEEauthorblockA{\textit{Dept. Electrical Engineering} \\
\textit{Tsinghua University}\\
Beijing, China \\
zhangtl16@mails.tsinghua.edu.cn}
\and
\IEEEauthorblockN{2\textsuperscript{nd} Haiwang Zhong}
\IEEEauthorblockA{\textit{Dept. Electrical Engineering} \\
\textit{Tsinghua University}\\
Beijing, China \\
zhonghw@tsinghua.edu.cn}
}

\maketitle

\begin{abstract}
    In this article, we present Misaka, a visualized swarm testbed for smart grid algorithm evaluation, also an extendable open-source open-hardware platform for developing tabletop tangible swarm interfaces\cite{yan2019consensus}.

    The platform consists of a collection of custom-designed 3 omni-directional wheels robots each 10 cm in diameter, high accuracy localization through a microdot pattern overlaid on top of the activity sheets, and a software framework for application development and control, while remaining affordable (per unit cost about 30 USD at the prototype stage). We illustrate the potential of tabletop swarm user interfaces through a set of smart grid algorithm development application scenarios developed with Misaka.
\end{abstract}

\begin{IEEEkeywords}
    Smart grid, Human-Robot Interaction, Swarm user interfaces, Tangible Robots, Testbed
\end{IEEEkeywords}

\section{Introduction}

Most recently, an increasing penetration of distributed energy resources (DERs) in Energy Internet imposes great challenges to conventional centralized economic dispatch\cite{yan2019consensus}.

The centralized controller requires a high-bandwidth communication infrastructure and a high level of connectivity, poses reliability concerns due to the presence of a single point-of-failure, and is prone to modeling error. Moreover, both the future power grid and the communication network are likely to have a variable topology, which further undermines the efficacy of centralized mechanisms\cite{binetti2013distributed}.

In the smart grid environment, the decision-making procedures are moving from centralized to distributed frameworks\cite{yang2011communication}.

But distributed algorithms are relatively difficult to understand, and need communication test to determine feasibility in real hardware scenario. So we present a swarm testbed to visualize and evaluate the algorithm and communication design of those newly proposed distributed frameworks for smart grid. A Misaka is a hardware and software system: a small omni-wheel robot with position sensing capabilities that can be freely arranged and repositioned on any horizontal surface, both through user manipulation and computer control. 

Due to Misakas’ ability to quickly and freely reconfigure themselves spatially, a collection of Misakas can act as a display and can provide meaningful user output such as multiple scatterplots and line charts. Due to their ability to sense user actions, Misakas can also support rich input. For example, users can move or rotate Misakas to change parameter and manipulate others Misakas.The system is relatively lightweight and only requires any surface, such as a sheet of paper or a game board, with simple printed structured patterns for real-time high-accuracy 2D localization.

To stimulate future research on swarm user interfaces, we distribute our Misaka tabletop swarm user interface platform in open-source and open-hardware.

In summary, our contributions are:

\begin{itemize}
    \item The first open-source hardware/software platform for smart grid algorithm evaluation with tabletop swarm user interfaces
    \item Redefinition for Algorithm Visualization with several implemented examples
    \item A set of scenarios to illustrate the unprecedented possibilities offered by Misaka swarm and by tabletop swarm user interfaces in general
    \item A common platform for any algorithm visualization, and other interactive swarm user interfaces
\end{itemize}

Furthermore, as benefits, Misaka:

\begin{itemize}
    \item are modular each unit, can be extended with powerful platform, such as NVIDIA Jetson NANO.
    \item can simulate real smart grid communication scenarios with Zigbee modular on board
    \item can interact with user moving and turning the robot or using the illuminated capacitive touch keys on the robot 
    \item can be manipulated either individually or collectively
    \item are small enough to also act as “pixels” of a physical display
    \item can coexist in large numbers
    \item are lightweight, can operate on any horizontal surface, and relatively cost-effective: about 30 USD each now, down to \$15 if mass manufactured.
\end{itemize}

\section{Test Algorithm Explanation}
\label{sec:Algorithm}

To explain Misaka usage in real smart grid algorithm evaluation scenario, we proposed a simplified average consensus algorithm to solve some distributed economic dispatch (DED) problems based on a consensus-based information exchange architecture, in which a generator only communicates with its neighbors. The algorithm is a linear consensus protocol based on Markov chain and incremental cost consensus (ICC) method.

Considering the actual situation, most complex algorithms require the central coordination node to distribute the transition matrix. The algorithm we proposed does not depend on the central node (coordinator) at the hardware level, aka completely decentralized. In addition, the operation of each node is very simple, and it has been proved that this algorithm converges in a strongly connected system.

A distributed solution must be supported by a communication network that provides its information flow, i.e., each generating unit exchanges information with a subset of other units to make autonomous decisions\cite{binetti2013distributed}. The communication connections can be described by a connected graph $G=(V, E)$ where $V=\left\{\nu_{1}, \nu_{2}, \ldots, \nu_{n}\right\}$ is the set of nodes, and $E \subset V \times V$
is the set of edges. An edge $\left(\nu_{j}, \nu_{i}\right) \in E$ from node $j$ to node $i$ exists if node $i$ can receive information from node $j$.

We use the adjacency matrix A of the directed graph to describe its communication topology:

\begin{equation}
    \mathbf{A}=\left[a_{i j}\right]_{N \times N}
\end{equation}

\begin{equation}
    a_{\mathrm{ij}}=\left\{\begin{array}{ll}
    {1} & {\text { if } j \text{ can receive information directly from } i } \\
    {0} & {\text { Otherwise }}
    \end{array}\right.
\end{equation}

The information flow can be described by a weighted graph, whose transition matrix $Q$ are composed by communication weights:

\begin{equation}
    q_{i j}=\frac{a_{i j}}{\sum_{k=1}^{N} a_{i k}}
\end{equation}

Then the consensus protocol can be formulated as follows.

\begin{equation}\boldsymbol{s}^{(k+1)}=\boldsymbol{Q} \boldsymbol{s}^{(k)}\end{equation}

The physical meaning of the algorithm is: At the same time during each iteration, all weights connected to the node are averaged and assigned to this node.

In terms of the transition matrix: each element in the $Q$ matrix is the corresponding adjacent matrix element divided by the node outdegree (the total number of edges emitted).

To demonstrate the algorithm performance, we proposed two typical cases:

Case 1 is a 4-generator directed graph given in fig~\ref{fig:Directed-graph}.

\begin{figure}[htbp] % use float package if you want it here
    \centering
    \includegraphics[width=0.8\columnwidth]{Directed-graph.pdf}
    \caption{Case 1 4-node directed graph}
    \label{fig:Directed-graph}
\end{figure}

The adjacency matrix A is:

\begin{equation}
    A=\left[\begin{array}{cccc}
    {1} & {1} & {0} & {0} \\
    {0} & {1} & {1} & {0} \\
    {1} & {0} & {1} & {1} \\
    {0} & {1} & {0} & {1}
    \end{array}\right]
\end{equation}

The transition matrix is:

\begin{equation}
    Q=\left[\begin{array}{cccc}
    {\frac{1}{2}} & {\frac{1}{2}} & {0} & {0} \\
    {0} & {\frac{1}{2}} & {\frac{1}{2}} & {0} \\
    {\frac{1}{3}} & {0} & {\frac{1}{3}} & {\frac{1}{3}} \\
    {0} & {\frac{1}{2}} & {0} & {\frac{1}{2}}
    \end{array}\right]
\end{equation}

Take an initial value of 1, 2, 3, 4 and iterate 10 times:

With the iteration, the price curve of each unit is shown in Figure~\ref{fig:Result-1234}.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\columnwidth]{1234.pdf}
    \caption{Case 1 price curve of each unit}
    \label{fig:Result-1234}
\end{figure}

As the iterations approach consensus data are shown in the table~\ref{tab:Result-1234}.

\begin{table}[htbp]
    \centering
    \begin{tabular}{|l|l|l|l|l|}
    \hline
    \diagbox{Iterations No.}{$X_{i,j}$}{Node No.}
       & 0        & 1        & 2        & 3        \\ \hline
    0  & 1        & 2        & 3        & 4        \\ \hline
    1  & 1.5      & 2.5      & 2.666667 & 3        \\ \hline
    2  & 2        & 2.583333 & 2.388889 & 2.75     \\ \hline
    3  & 2.291667 & 2.486111 & 2.37963  & 2.666667 \\ \hline
    4  & 2.388889 & 2.43287  & 2.445988 & 2.576389 \\ \hline
    5  & 2.41088  & 2.439429 & 2.470422 & 2.50463  \\ \hline
    6  & 2.425154 & 2.454925 & 2.461977 & 2.472029 \\ \hline
    7  & 2.44004  & 2.458451 & 2.453054 & 2.463477 \\ \hline
    8  & 2.449246 & 2.455752 & 2.45219  & 2.460964 \\ \hline
    9  & 2.452499 & 2.453971 & 2.454133 & 2.458358 \\ \hline
    10 & 2.453235 & 2.454052 & 2.454997 & 2.456165 \\ \hline
    \end{tabular}
    \caption{Case 1 iteration data}
    \label{tab:Result-1234}
\end{table}

For a non-strongly connected graph, the strongly connected component of the directed graph will produce a global error iteration result because of the unidirectionally connected nodes. It is necessary to ensure that the communication error nodes are eliminated at all times. The handshake protocol can be used to ensure the reliability of two-way communication.

As an example, case 2 is a 10-node system, the values of nodes 1-10 correspond to 1-10 respectively, and the original adjacency matrix A is shown in the table~\ref{tab:Error-A}.

\begin{table}[htbp]
    \centering
    \begin{tabular}{|l|l|l|l|l|l|l|l|l|l|l|}
    \hline
    \diagbox{i}{$A_{i,j}$}{j}
       & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\ \hline
    1  & 1 & 1 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 0  \\ \hline
    2  & 0 & 1 & 1 & 0 & 0 & 0 & 1 & 0 & 1 & 0  \\ \hline
    3  & 1 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 0 & 1  \\ \hline
    4  & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 0 & 1 & 0  \\ \hline
    5  & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 1  \\ \hline
    6  & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 0 & 0  \\ \hline
    7  & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 1  \\ \hline
    8  & 0 & 1 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0  \\ \hline
    9  & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0  \\ \hline
    10 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 0 & 1 & 1  \\ \hline
    \end{tabular}
    \caption{Non-strongly connected graph counterexample adjacency matrix A}
    \label{tab:Error-A}
\end{table}

Note that node 9 has no way to receive information from other nodes and becomes a strongly connected component separate from other nodes, make the entire network erroneously converge to the value of node 9, which is shown in fig~\ref{fig:123456-Error}.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\columnwidth]{123456-Error.pdf}
    \caption{Non-strongly connected graph iteration curve}
    \label{fig:123456-Error}
\end{figure}

After connect the directed edges from nodes 9 to 1, it will become a strongly connected system and converge normally, which is shown in fig~\ref{fig:123456-Correct}.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\columnwidth]{123456-Correct.pdf}
    \caption{Case 2 strongly connected graph iteration curve}
    \label{fig:123456-Correct}
\end{figure}






\section{UI examples eith Misaka}

To illustrate the potential of tabletop swarm user interfaces, we present a set of smart grid algorithm development application scenarios developed with Misaka.

\subsection{Dynamic iteration process physicalization}

In the dynamic iterative visualization mode, the working surface is regarded as a two-dimensional rectangular coordinates, each Misaka represents a generator node, and the vertical axis position of Misaka in the rectangular coordinates represents its current output, changing with each iteration. This system also simulate the communication process and perform decentralized autonomous optimization. When the number of nodes (newly added or withdrawn) or any node data changes, the system will restart dynamic iteration. The initial value can be set by the position of Misaka at the beginning, also Misaka can be manually moved at any time during or after the iteration to change the value of nodes.

In other words, we can interact with the algorithm, more interaction methods will be further discussed in the next section.

The relationship between physical world and algorithms is shown as the table~\ref{tab:Real-Unreal}.

\begin{table}[htbp]
    \centering
    \begin{tabular}{@{}ll@{}}
    \hline
    physical world          & algorithms                               \\ \hline
    working surface         & two-dimensional rectangular coordinates  \\
    Move forward            & vertical axis                            \\
    single Misaka           & node                                     \\
    place new Misaka        & add new node and set initial value       \\
    remove a Misaka         & disconnect a node                        \\ \hline
    \end{tabular}
    \caption{relationship between physical world and algorithms}
    \label{tab:Real-Unreal}
\end{table}



% 在这加Illustration摆拍以及解释简笔画，拍的视频直接传YouTube交给审稿就行了


\subsection{Information transmission visualization}

% 在这加PPT Illustration


\subsection{Time-series navigation}

We used Misaka to visualize and navigate in time-series data.

\subsection{Multiple scatterplots}


\section{Hardware and software design}

There are many tangible robots such as Zooids\cite{le2016zooids} and Cellulo\cite{ozgur2017cellulo}. We refer to their design and carefully designed Misaka testbed according to our specific application scenario.

\subsection{Hardware}

% 可选加个渲染图或者实物图带标签

Traditional two wheels differential drive normally used on mobile robots have manoeuvrability limitations and take time to sort out\cite{ribeiro2004three}. 

An Omni wheel has an axis perpendicular to the axis of the core wheel, This allows the wheels to move in two directions, Omni-wheeled robots can move at any angle in any direction, without rotating beforehand.

We use custom-designed platform with three omni-directional wheels, drvied by micro stepper motor to precisely control the rotation angle of each wheel.

real-time high-accuracy 2D localization technique for mobile robots, based on simple printed patterns, building over algorithms previously developed for digital pens\cite{hostettler2016real}.

% 可以摆拍个图片

Users can modify Misaka for their applications by designing custom modules that attach to its core module or adding powerful chips and development boards to achieve more functions, such as computer vision, wifi, machine learning algorithms, etc.

For example, in order to give Misaka Linux development environment and capabilities of testing machine learning algorithms, we add Nvidia Jetson Nano to Misaka core through UART. And to connect them with bluetooth and wifi, we add ESP32 modules. 

\subsection{Software}

\section{Limitations and future work}

\section{Conclusion}




\bibliographystyle{IEEEtran}
\bibliography{IEEEabrv,refs}

\end{document}
